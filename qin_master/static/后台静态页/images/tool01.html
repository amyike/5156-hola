<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>亲邻网管理后台</title>
<link href="../style.css" rel="stylesheet" type="text/css">
<link href="index_data/box.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="index_data/common.js"></script>
<script type="text/javascript" src="index_data/box.js"></script>
</head>
<body>
<div class="so_main">
  <!-- 备份选项 -->
  <div id="begin_backup" style="display:none;">
    <div class="page_tit">备份选项 [ <a href="javascript:void(0);" onClick="$('#begin_backup').slideUp();">隐藏</a> ]</div>
    
    <div class="form2">
    <form method="post" action="http://211.155.227.148:6688/index.php?app=admin&amp;mod=Tool&amp;act=doBackUp">
    <dl class="lineD">
      <dt>选项: </dt>
      <dd>
        <input name="backup_type" value="all" checked="checked" onClick="$('#backup_size').removeClass('lineD');$('#backup_table').slideUp();" type="radio">全部备份<br>
        <input name="backup_type" value="custom" onClick="$('#backup_size').addClass('lineD');$('#backup_table').slideDown();" type="radio">选择备份
      </dd>
    </dl>
    <dl class="" id="backup_size">
      <dt>分卷大小: </dt>
      <dd>
        <input name="sizelimit" value="1000" type="text"> K
      </dd>
    </dl>
    <dl class="" id="backup_table" style="display:none">
        <dt>数据库表: </dt>
        <dd>
        <input name="backup_table[]" value="ts_ad" type="checkbox">ts_ad ( 0 Bytes )<br><input name="backup_table[]" value="ts_admin_log" type="checkbox">ts_admin_log ( 37.7 KB )<br><input name="backup_table[]" value="ts_app" type="checkbox">ts_app ( 0 Bytes )<br><input name="backup_table[]" value="ts_area" type="checkbox">ts_area ( 78.67 KB )<br><input name="backup_table[]" value="ts_attach" type="checkbox">ts_attach ( 0 Bytes )<br><input name="backup_table[]" value="ts_category" type="checkbox">ts_category ( 0 Bytes )<br><input name="backup_table[]" value="ts_comment" type="checkbox">ts_comment ( 0 Bytes )<br><input name="backup_table[]" value="ts_credit_setting" type="checkbox">ts_credit_setting ( 2.39 KB )<br><input name="backup_table[]" value="ts_credit_type" type="checkbox">ts_credit_type ( 52 Bytes )<br><input name="backup_table[]" value="ts_credit_user" type="checkbox">ts_credit_user ( 289 Bytes )<br><input name="backup_table[]" value="ts_denounce" type="checkbox">ts_denounce ( 0 Bytes )<br><input name="backup_table[]" value="ts_document" type="checkbox">ts_document ( 896 Bytes )<br><input name="backup_table[]" value="ts_expression" type="checkbox">ts_expression ( 812 Bytes )<br><input name="backup_table[]" value="ts_feed" type="checkbox">ts_feed ( 3.17 KB )<br><input name="backup_table[]" value="ts_friend" type="checkbox">ts_friend ( 0 Bytes )<br><input name="backup_table[]" value="ts_friend_group" type="checkbox">ts_friend_group ( 0 Bytes )<br><input name="backup_table[]" value="ts_friend_group_link" type="checkbox">ts_friend_group_link ( 0 Bytes )<br><input name="backup_table[]" value="ts_invite_record" type="checkbox">ts_invite_record ( 0 Bytes )<br><input name="backup_table[]" value="ts_invitecode" type="checkbox">ts_invitecode ( 0 Bytes )<br><input name="backup_table[]" value="ts_jobs" type="checkbox">ts_jobs ( 504 Bytes )<br><input name="backup_table[]" value="ts_login" type="checkbox">ts_login ( 0 Bytes )<br><input name="backup_table[]" value="ts_login_record" type="checkbox">ts_login_record ( 7.98 KB )<br><input name="backup_table[]" value="ts_medal" type="checkbox">ts_medal ( 0 Bytes )<br><input name="backup_table[]" value="ts_message" type="checkbox">ts_message ( 360 Bytes )<br><input name="backup_table[]" value="ts_myop_friendlog" type="checkbox">ts_myop_friendlog ( 732 Bytes )<br><input name="backup_table[]" value="ts_myop_myapp" type="checkbox">ts_myop_myapp ( 0 Bytes )<br><input name="backup_table[]" value="ts_myop_myinvite" type="checkbox">ts_myop_myinvite ( 0 Bytes )<br><input name="backup_table[]" value="ts_myop_userapp" type="checkbox">ts_myop_userapp ( 0 Bytes )<br><input name="backup_table[]" value="ts_myop_userappfield" type="checkbox">ts_myop_userappfield ( 0 Bytes )<br><input name="backup_table[]" value="ts_myop_userlog" type="checkbox">ts_myop_userlog ( 400 Bytes )<br><input name="backup_table[]" value="ts_node" type="checkbox">ts_node ( 140 Bytes )<br><input name="backup_table[]" value="ts_notify" type="checkbox">ts_notify ( 1.42 KB )<br><input name="backup_table[]" value="ts_space" type="checkbox">ts_space ( 280 Bytes )<br><input name="backup_table[]" value="ts_system_data" type="checkbox">ts_system_data ( 15.61 KB )<br><input name="backup_table[]" value="ts_tag" type="checkbox">ts_tag ( 0 Bytes )<br><input name="backup_table[]" value="ts_template" type="checkbox">ts_template ( 152 Bytes )<br><input name="backup_table[]" value="ts_template_record" type="checkbox">ts_template_record ( 0 Bytes )<br><input name="backup_table[]" value="ts_ucenter_user_link" type="checkbox">ts_ucenter_user_link ( 0 Bytes )<br><input name="backup_table[]" value="ts_user" type="checkbox">ts_user ( 2.34 KB )<br><input name="backup_table[]" value="ts_user_app" type="checkbox">ts_user_app ( 0 Bytes )<br><input name="backup_table[]" value="ts_user_blacklist" type="checkbox">ts_user_blacklist ( 0 Bytes )<br><input name="backup_table[]" value="ts_user_count" type="checkbox">ts_user_count ( 11 Bytes )<br><input name="backup_table[]" value="ts_user_group" type="checkbox">ts_user_group ( 116 Bytes )<br><input name="backup_table[]" value="ts_user_group_link" type="checkbox">ts_user_group_link ( 552 Bytes )<br><input name="backup_table[]" value="ts_user_group_popedom" type="checkbox">ts_user_group_popedom ( 13 Bytes )<br><input name="backup_table[]" value="ts_user_medal" type="checkbox">ts_user_medal ( 0 Bytes )<br><input name="backup_table[]" value="ts_user_online" type="checkbox">ts_user_online ( 171 Bytes )<br><input name="backup_table[]" value="ts_user_privacy" type="checkbox">ts_user_privacy ( 0 Bytes )<br><input name="backup_table[]" value="ts_user_profile" type="checkbox">ts_user_profile ( 0 Bytes )<br><input name="backup_table[]" value="ts_user_set" type="checkbox">ts_user_set ( 456 Bytes )<br><input name="backup_table[]" value="ts_user_tag" type="checkbox">ts_user_tag ( 0 Bytes )<br><input name="backup_table[]" value="ts_user_verified" type="checkbox">ts_user_verified ( 0 Bytes )<br><input name="backup_table[]" value="ts_user_visited" type="checkbox">ts_user_visited ( 289 Bytes )<br><input name="backup_table[]" value="ts_validation" type="checkbox">ts_validation ( 0 Bytes )<br><input name="backup_table[]" value="ts_weibo" type="checkbox">ts_weibo ( 17.64 KB )<br><input name="backup_table[]" value="ts_weibo_atme" type="checkbox">ts_weibo_atme ( 54 Bytes )<br><input name="backup_table[]" value="ts_weibo_comment" type="checkbox">ts_weibo_comment ( 604 Bytes )<br><input name="backup_table[]" value="ts_weibo_config" type="checkbox">ts_weibo_config ( 0 Bytes )<br><input name="backup_table[]" value="ts_weibo_favorite" type="checkbox">ts_weibo_favorite ( 54 Bytes )<br><input name="backup_table[]" value="ts_weibo_follow" type="checkbox">ts_weibo_follow ( 434 Bytes )<br><input name="backup_table[]" value="ts_weibo_follow_group" type="checkbox">ts_weibo_follow_group ( 0 Bytes )<br><input name="backup_table[]" value="ts_weibo_follow_group_link" type="checkbox">ts_weibo_follow_group_link ( 0 Bytes )<br><input name="backup_table[]" value="ts_weibo_plugin" type="checkbox">ts_weibo_plugin ( 72 Bytes )<br><input name="backup_table[]" value="ts_weibo_star" type="checkbox">ts_weibo_star ( 0 Bytes )<br><input name="backup_table[]" value="ts_weibo_star_group" type="checkbox">ts_weibo_star_group ( 20 Bytes )<br><input name="backup_table[]" value="ts_weibo_topic" type="checkbox">ts_weibo_topic ( 84 Bytes )<br><input name="backup_table[]" value="ts_weibo_topics" type="checkbox">ts_weibo_topics ( 0 Bytes )<br><input name="backup_table[]" value="ts_xqtable" type="checkbox">ts_xqtable ( 261.65 KB )<br>        </dd>
    </dl>
    <div class="page_btm">
      <input class="btn_b" value="确定" type="submit">
    </div>
    <input name="__hash__" value="8ac13ec2b295d4485b800d42f86d7aed" type="hidden"></form>
  </div>
  </div>
  
  <div class="page_tit">数据备份</div>
  <div class="Toolbar_inbox">
    <a href="javascript:void(0);" class="btn_a" onClick="$('#begin_backup').slideDown();"><span>开始备份</span></a>
    <a href="javascript:void(0);" class="btn_a" onClick="del();"><span>删除备份</span></a>
  </div>
  
  <div class="list">
  <table id="backup_list" border="0" cellpadding="0" cellspacing="0" width="100%">
  <tbody><tr>
    <th style="width: 30px;">
        <input id="checkbox_handle" onClick="checkAll(this)" value="0" type="checkbox">
        <label for="checkbox"></label>
    </th>
    <th class="line_l">文件名(data/database/...)</th>
    <th class="line_l">备份时间</th>
    <th class="line_l">文件大小</th>
    <th class="line_l">操作</th>
  </tr>
    </tbody></table>

  </div>
  <div class="Toolbar_inbox">
    <a href="javascript:void(0);" class="btn_a" onClick="$('#begin_backup').slideDown();"><span>开始备份</span></a>
    <a href="javascript:void(0);" class="btn_a" onClick="del();"><span>删除备份</span></a>
  </div>
</div>

<script>
    function checkon(o){
        if( o.checked == true ){
            $(o).parents('tr').addClass('bg_on') ;
        }else{
            $(o).parents('tr').removeClass('bg_on') ;
        }
    }
    
    function checkAll(o){
        if( o.checked == true ){
            $('input[name="checkbox"]').attr('checked','true');
            $('tr[overstyle="on"]').addClass("bg_on");
        }else{
            $('input[name="checkbox"]').removeAttr('checked');
            $('tr[overstyle="on"]').removeClass("bg_on");
        }
    }

    //获取已选择用户的ID数组
    function getChecked() {
        var gids = new Array();
        $.each($('input:checked'), function(i, n){
            gids.push( $(n).val() );
        });
        return gids;
    }

    //删除备份文件
    function delsql(bid) {
        bid = bid ? bid : getChecked();
        bid = bid.toString();
        if(bid == '')
        	return false;
        
        if(!confirm('删除后无法恢复，确定删除？'))
        	return false;

        //提交删除
        $.post("http://211.155.227.148:6688/index.php?app=admin&mod=Tool&act=doDeleteBackUp", {selected:bid}, function(res){
            if(res == '1') {
                bid = bid.split(',');
                $.each(bid, function(i,n){
                    $('#backup_'+n).remove();
                });
                ui.success('删除成功');
            }else {
                ui.error('删除失败');
            }
        });
    }
    
    function importsql( filename ){
    	if(!confirm('导入后数据库数据将被完全覆盖，确定导入？'))
        	return false;

    	window.location.href = "http://211.155.227.148:6688/index.php?app=admin&mod=Tool&act=import&filename=" + filename;
    }
    
  //鼠标移动表格效果
    $(document).ready(function(){
        $("tr[overstyle='on']").hover(
          function () {
            $(this).addClass("bg_hover");
          },
          function () {
            $(this).removeClass("bg_hover");
          }
        );
    });
</script>


</body></html>